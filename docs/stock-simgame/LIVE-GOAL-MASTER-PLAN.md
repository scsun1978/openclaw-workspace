# LIVE-GOAL-MASTER-PLAN

- Task: `T-STOCK-SIMGAME-LIVE-004`
- Version: `v1.0`
- Date: `2026-02-18`
- Scope: Unified execution blueprint from Code / QA / Docs baselines

---

## 1) 目标定义（可真实游玩的最小成功标准）

## 核心目标
在 W4 结束时交付一个**可真实游玩、可稳定运行、可文档化运维**的 MVP 版本，满足以下最小标准：

1. 玩家可完成完整闭环：
   - 注册/登录
   - 查看行情
   - 下单（买/卖）
   - 查看持仓与资产变动
2. 核心服务稳定：
   - WebSocket 实时推送可用
   - PostgreSQL/Redis 数据一致性可验证
3. 质量达标：
   - 关键链路验收通过率 ≥ 95%
   - SLO 目标：99.9%（可观测窗口内）
4. 文档可执行：
   - 玩家接入文档、运维 Runbook、发布手册齐全

## MVP 成功判定（Definition of Success）

- 功能：P0 用户主链路 100% 可用
- 性能：并发压测达到阶段目标（详见 QA 矩阵）
- 可靠性：故障注入后可恢复，核心数据不丢失
- 文档：W1-W4 计划文档全部交付并可复现执行

---

## 2) 统一阶段路线图（W1-W4 优先）

## 全局阶段（12 周中前 4 周落地）

- **阶段 A（W1-W4）：MVP 建设与上线准备（本计划重点）**
- 阶段 B（W5-W8）：性能与可靠性扩展
- 阶段 C（W9-W12）：运营化、规模化与发布优化

## W1-W4 路线图（统一版）

### W1：基础骨架与标准化
- 代码：服务骨架（WS + PG + Redis + JWT）
- QA：验收矩阵初始化、基线测试环境
- Docs：玩家接入/开发说明/接口约定文档起稿
- 产出：可启动环境 + 首批文档 + 首轮测试清单

### W2：核心交易闭环
- 代码：订单/持仓主链路完成（最小可用）
- QA：核心链路功能测试 + 数据一致性检查
- Docs：交易流程文档、错误码、故障排查初版
- 产出：可玩主流程（内测）

### W3：稳定性与故障恢复
- 代码：WS 降级轮询、重连机制、缓存策略
- QA：故障注入（服务重启/网络抖动/Redis异常）
- Docs：运维 Runbook、应急处理 SOP
- 产出：故障场景可恢复，风险可控

### W4：发布准备与 Gate
- 代码：性能优化与发布候选版本（RC）
- QA：并发压测（50→200→500→1000 TPS 分层）+ SLO 校验
- Docs：发布手册、变更说明、已知问题清单
- 产出：Go/No-Go 最终决策包

---

## 3) 关键依赖与风险清单（Code/QA/Docs 合并）

## 关键依赖

1. 基础设施依赖
   - Docker/Compose 可用性
   - PostgreSQL/Redis 连接稳定
2. 研发依赖
   - WebSocket 推送正确性
   - 市场模型与订单状态机一致性
3. 质量依赖
   - 压测环境与数据样本可复现
   - 故障注入工具链可执行
4. 文档依赖
   - 代码接口变更同步到文档
   - 发布流程文档与实际脚本一致

## 风险清单（合并）

1. **R1/P0：WS 重连与轮询降级不一致**
   - 影响：实时数据错乱、用户体验断裂
2. **R2/P0：订单/持仓数据一致性问题（PG/Redis）**
   - 影响：资产错误、交易不可追溯
3. **R3/P1：压测目标达不成（>=500 TPS 阶段）**
   - 影响：发布窗口延期
4. **R4/P1：文档与实现脱节**
   - 影响：运维与发布误操作
5. **R5/P1：故障注入回滚流程不完整**
   - 影响：事故恢复时间拉长

---

## 4) 决策点（Go/No-Go 判定规则）

## Gate 判定级别

- **GO（GREEN）**：全部 P0 验收通过，P1 可控，有明确修复窗口
- **CONDITIONAL（YELLOW）**：存在非阻断风险，需限流发布或灰度
- **NO-GO（RED）**：任一 P0 未闭环，禁止上线

## W4 Go/No-Go 硬门槛

1. 功能门槛
   - P0 主链路 100% 通过
2. 质量门槛
   - 关键验收矩阵通过率 ≥ 95%
   - 故障注入关键场景通过
3. 性能门槛
   - 分层压测达到目标区间并有证据
4. 可靠性门槛
   - SLO 指标达到 99.9% 目标（观察窗口）
5. 文档门槛
   - Runbook/发布手册/玩家接入文档可执行验证通过

---

## 5) W1-W4 落地清单（按 owner 分配到 4 个 agent）

## scsun-code-agent

- W1
  - 搭建服务骨架（WS + PG + Redis + JWT）
  - 输出模块边界与目录结构
- W2
  - 完成订单/持仓最小闭环
  - 提供可复现 seed 接口与状态查询
- W3
  - 完成 WS 降级与重连实现
  - 修复故障注入暴露的 P0/P1
- W4
  - 性能优化、RC 构建、发布候选提交

## scsun-qa-agent

- W1
  - 建立验收矩阵（功能/一致性/性能/恢复）
  - 建立测试环境矩阵
- W2
  - 主链路功能测试与回归
  - 缺陷分级与 MTTR 跟踪
- W3
  - 故障注入测试（网络/服务/缓存）
  - 恢复路径验证与证据沉淀
- W4
  - 分层压测（50-1000 TPS）
  - 输出 Go/No-Go 测试结论

## scsun-docs-agent

- W1
  - 玩家接入文档、开发对接文档、术语与错误码
- W2
  - 交易流程文档、API 文档、FAQ 初版
- W3
  - 运维 Runbook、故障排查手册、值班 SOP
- W4
  - 发布手册、变更公告模板、回滚指引、已知风险清单

## scsun-monitor-agent

- W1
  - 建立周节奏（周一计划/周三纠偏/周五 Gate）
  - 建立风险看板与升级路径
- W2
  - 盯主链路闭环，推动 P0 清零
- W3
  - 聚焦故障注入与恢复闭环，触发必要升级
- W4
  - 汇总三方证据，执行最终 Gate Review（GO/NO-GO）

---

## 6) 执行建议（首周开工清单）

## Day 1（启动会）

1. 锁定 W1 范围与 DoD（Definition of Done）
2. 确认仓库结构、分支策略、提交流程
3. 确认 QA 环境与文档目录结构

## Day 2-3（骨架落地）

1. Code 完成最小服务可启动
2. QA 完成基线测试脚手架
3. Docs 完成玩家接入与开发说明初稿

## Day 4（中期检查）

1. Monitor 执行 Mid-week Health Check
2. 识别偏差并重排优先级
3. 对 P0 风险发起快速修复

## Day 5（周 Gate）

1. 汇总本周证据（commit/test/doc）
2. 输出 W1 Gate 结论（GREEN/YELLOW/RED）
3. 决定是否进入 W2 或留在修复周

---

## 附：执行纪律（必须遵守）

1. 证据优先：所有结论必须有 commit/test/doc 路径支撑
2. 闸门优先：Gate 不通过，不推进下一阶段
3. 升级及时：P0 > 30 分钟未解除，立即升级到 Monitor/Owner
4. 文档同步：接口或流程变更 24h 内同步到文档

---

**本文件即最终统一执行蓝图（ROADMAP v1 Live Plan）。**
